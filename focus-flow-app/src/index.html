<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>FocusFlow - OSãƒ¬ãƒ™ãƒ«é€šçŸ¥åˆ¶å¾¡ãƒ†ã‚¹ãƒˆ</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <h1>ğŸ¯ FocusFlow</h1>
    <p>å€‹äººã®é›†ä¸­ã¨çŸ¥çš„ç”Ÿç”£æ€§ã‚’æœ€å¤§åŒ–ã™ã‚‹ãƒ‡ã‚¸ã‚¿ãƒ«ä¼´èµ°è€…</p>
    
    <div id="platform-info">
      <h3>Platform Information</h3>
      <p>OS: <span id="os-info">Loading...</span></p>
      <p>Node.js: <span id="node-info">Loading...</span></p>
      <p>Electron: <span id="electron-info">Loading...</span></p>
    </div>
    
    <div id="focus-mode-controls">
      <h3>Focus Mode Controls</h3>
      <div style="margin: 10px 0;">
        <button id="start-focus-btn">ğŸ¯ Start Focus Mode</button>
        <button id="stop-focus-btn">â¹ï¸ Stop Focus Mode</button>
        <button id="test-notification-btn">ğŸ”” Test Notification</button>
      </div>
      <div id="focus-status">
        <p>Status: <span id="focus-mode-status">âšª Off</span></p>
      </div>
    </div>
    
    <div id="notification-test">
      <h3>Notification Control Test</h3>
      <p>é€šçŸ¥åˆ¶å¾¡ãƒ†ã‚¹ãƒˆãŒ5ç§’å¾Œã«è‡ªå‹•å®Ÿè¡Œã•ã‚Œã¾ã™</p>
      <ul>
        <li>é€šçŸ¥ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—è¡¨ç¤ºãƒ†ã‚¹ãƒˆï¼ˆéŸ³ãªã—ï¼‰</li>
        <li>ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ¢ãƒ¼ãƒ‰é–‹å§‹ï¼ˆ3ç§’å¾Œï¼‰</li>
        <li>é€šçŸ¥ãƒ–ãƒ­ãƒƒã‚¯ãƒ†ã‚¹ãƒˆï¼ˆ6ç§’å¾Œï¼‰</li>
        <li>ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ¢ãƒ¼ãƒ‰çµ‚äº†ï¼ˆ11ç§’å¾Œï¼‰</li>
      </ul>
    </div>
    
    <div id="windows-focus-assist">
      <h3>Windows é›†ä¸­ãƒ¢ãƒ¼ãƒ‰é€£æº</h3>
      <p>ã‚¢ãƒ—ãƒªé–‹å§‹2ç§’å¾Œã«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ç¢ºèªæ‰‹é †ã‚’è¡¨ç¤ºã—ã¾ã™</p>
      <ol>
        <li>Windowsè¨­å®š (Win + I) ã‚’é–‹ã</li>
        <li>ã€Œã‚·ã‚¹ãƒ†ãƒ ã€â†’ã€Œé›†ä¸­ãƒ¢ãƒ¼ãƒ‰ã€ã‚’é–‹ã</li>
        <li>FocusFlowã§ã€ŒStart Focus Modeã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
        <li>é›†ä¸­ãƒ¢ãƒ¼ãƒ‰ã®çŠ¶æ…‹å¤‰åŒ–ã‚’ç¢ºèª</li>
      </ol>
    </div>
    
    <script>
      // ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’è¡¨ç¤º
      console.log('FocusFlow frontend: Script starting');
      
      // electronAPIãŒåˆ©ç”¨å¯èƒ½ã‹ãƒã‚§ãƒƒã‚¯
      if (window.electronAPI) {
        console.log('FocusFlow frontend: electronAPI available');
        
        // ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ æƒ…å ±ã‚’éåŒæœŸã§å–å¾—
        async function loadSystemInfo() {
          try {
            const systemInfo = await window.electronAPI.getSystemInfo();
            document.getElementById('os-info').innerText = systemInfo.platform;
            document.getElementById('node-info').innerText = systemInfo.nodeVersion;
            document.getElementById('electron-info').innerText = systemInfo.electronVersion;
            console.log('FocusFlow frontend: System info loaded successfully');
          } catch (error) {
            console.error('System info error:', error);
            document.getElementById('os-info').innerText = 'Error loading info';
            document.getElementById('node-info').innerText = 'Error loading info';
            document.getElementById('electron-info').innerText = 'Error loading info';
          }
        }
        
        // ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ã‚’èª­ã¿è¾¼ã¿
        loadSystemInfo();
        
        // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ¢ãƒ¼ãƒ‰åˆ¶å¾¡
        let focusModeActive = false;
        
        document.getElementById('start-focus-btn').addEventListener('click', async () => {
          try {
            console.log('FocusFlow frontend: Starting focus mode');
            const result = await window.electronAPI.startFocusMode();
            console.log('Focus mode result:', result);
            
            // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å®Ÿéš›ã®çŠ¶æ…‹ã‚’å–å¾—
            const statusResult = await window.electronAPI.getFocusStatus();
            console.log('Focus status after start:', statusResult);
            
            focusModeActive = statusResult.focusMode;
            document.getElementById('focus-mode-status').innerHTML = focusModeActive ? 'ğŸ”´ On' : 'âšª Off';
          } catch (error) {
            console.error('Start focus mode error:', error);
            alert('Focus mode start failed: ' + error.message);
          }
        });
        
        document.getElementById('stop-focus-btn').addEventListener('click', async () => {
          try {
            console.log('FocusFlow frontend: Stopping focus mode');
            const result = await window.electronAPI.stopFocusMode();
            console.log('Stop focus mode result:', result);
            
            // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å®Ÿéš›ã®çŠ¶æ…‹ã‚’å–å¾—
            const statusResult = await window.electronAPI.getFocusStatus();
            console.log('Focus status after stop:', statusResult);
            
            focusModeActive = statusResult.focusMode;
            document.getElementById('focus-mode-status').innerHTML = focusModeActive ? 'ğŸ”´ On' : 'âšª Off';
          } catch (error) {
            console.error('Stop focus mode error:', error);
            alert('Focus mode stop failed: ' + error.message);
          }
        });
        
        document.getElementById('test-notification-btn').addEventListener('click', async () => {
          try {
            console.log('FocusFlow frontend: Testing notification');
            console.log('Current focus mode active:', focusModeActive);
            
            const result = await window.electronAPI.testNotification();
            console.log('Test notification result:', result);
            
            if (result.success) {
              if (result.blocked) {
                console.log('âœ… Notification BLOCKED - Focus mode working correctly');
                alert('âœ… Focus Mode Working!\nNotification was blocked because Focus Mode is active.');
              } else {
                console.log('âœ… Notification SENT - Normal mode working correctly');
                alert('âœ… Normal Mode Working!\nNotification was sent because Focus Mode is off.');
              }
            } else {
              console.warn('Notification failed:', result.status);
              alert('Notification test failed: ' + result.status);
            }
          } catch (error) {
            console.error('Test notification error:', error);
            alert('Notification test failed: ' + error.message);
          }
        });
        
      } else {
        console.error('FocusFlow frontend: electronAPI not available');
        document.getElementById('os-info').innerText = 'electronAPI not available';
        document.getElementById('node-info').innerText = 'Check console for errors';
        document.getElementById('electron-info').innerText = 'Reload app';
        
        // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
        document.getElementById('start-focus-btn').disabled = true;
        document.getElementById('stop-focus-btn').disabled = true;
        document.getElementById('test-notification-btn').disabled = true;
        
        alert('electronAPI not available. Check console for errors.');
      }
      
      console.log('FocusFlow frontend loaded');
    </script>
  </body>
</html>
