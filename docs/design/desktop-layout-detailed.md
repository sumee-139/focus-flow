# デスクトップレイアウト詳細設計

## 設計哲学の適用

### FocusFlowらしいデスクトップ体験
**Reference**: @docs/design-philosophy.md

- **集中力への献身**: デスクトップの広い画面を活用して、情報を整理し視覚的ノイズを最小化
- **Calm Technology**: 主役は作業内容、UIは脇役に徹する
- **その日必ず着手するタスク**: デスクトップでは長時間作業に適したレイアウト

---

## 1. Phase 1 デスクトップレイアウト（MVP）

### 1.1 基本構造（Markdownエディタ中心設計）
```
┌─────────────────────────────────────────────────────────────┐
│ FocusFlow                    [🔍] [add] [notifications] [⚙️] │ 64px
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ ┌─────────┐ ┌─────────────────────────────────────────────┐ │
│ │         │ │                                             │ │
│ │ Nav     │ │           📝 デイリーメモ                   │ │
│ │ 🏠      │ │         (メインエリア)                       │ │
│ │ 📝      │ │                                             │ │
│ │ 🎯      │ │   ┌─────────────────────────────────────┐   │ │
│ │ ⚙️      │ │   │ ## 今日のメモ                       │   │ │
│ │         │ │   │                                     │   │ │
│ │─────────│ │   │ - UI設計の最終確認が必要             │   │ │
│ │📝 Tasks │ │   │ - API連携の仕様変更あり              │   │ │
│ │(Compact)│ │   │                                     │   │ │
│ │React設計│ │   │ **アイデア**: タスクの並び順を...    │   │ │
│ │API仕様書│ │   │                                     │   │ │
│ │メール返信│ │   │ 明日: 会議資料の準備                 │   │ │
│ │         │ │   │                                     │   │ │
│ └─────────┘ │   │ [大きなMarkdown編集エリア]           │   │ │
│     200px   │   └─────────────────────────────────────┘   │ │
│             │                                             │ │
└─────────────┴─────────────────────────────────────────────┘ │
│                         メイン領域（70%+）                  │
└─────────────────────────────────────────────────────────────┘
```

### 1.2 Phase 1 特化設計のポイント

#### 機能の優先度見直し
- **Phase 1メイン機能**: デイリーメモ（Markdownエディタ）が中心
- **Phase 1サブ機能**: タスク管理（コンパクト表示）、フォーカスモード
- **除外機能**: 統計・分析、カレンダー、高度な検索
- **設計方針**: 思考の記録と整理を最優先、見た目はMarkdownエディタ

#### サイドバーの最適化（コンパクト設計）
```
┌─────────────────┐
│ 🏠 ダッシュボード │ ← 今日の概要  
│ 📝 メモ＆タスク  │ ← メイン画面
│ 🎯 集中モード    │ ← フォーカス
│ ⚙️ 設定         │ ← 最小限設定
│─────────────────│
│ 📝 今日のタスク  │ ← コンパクト
│ ┌─────────────┐ │
│ │ • React設計  │ │ ← 短縮表示
│ │ • API仕様書  │ │
│ │ • メール返信  │ │
│ │             │ │
│ │ [+ 新規]     │ │
│ └─────────────┘ │
└─────────────────┘
```

---

## 2. 画面別詳細レイアウト

### 2.1 ダッシュボード（Markdownエディタ中心）
```
┌─────────────────────────────────────────────────────────────┐
│ FocusFlow                    [🔍] [add] [notifications] [⚙️] │
├─────┬───────────────────────────────────────────────────────┤
│ 🏠  │ ┌─────────────────────────────────────────────────┐   │
│ 📝  │ │ 📝 今日のデイリーメモ                            │   │
│ 🎯  │ │ ┌─────────────────────────────────────────────┐ │   │
│ ⚙️  │ │ │ ## 今日のポイント                           │ │   │
│─────│ │ │                                             │ │   │
│ 📝  │ │ │ - UI設計の最終確認が必要                     │ │   │
│Tasks│ │ │ - API連携の仕様変更あり                      │ │   │
│     │ │ │ - チーム会議で決定事項を共有                  │ │   │
│React│ │ │                                             │ │   │
│API  │ │ │ **💡 アイデア**                              │ │   │
│Mail │ │ │ タスクの並び順をドラッグで変更できると        │ │   │
│     │ │ │ 便利かも。優先度に頼らない直感的な管理。       │ │   │
│[+]  │ │ │                                             │ │   │
│     │ │ │ **📋 明日への引き継ぎ**                      │ │   │
│     │ │ │ - 会議資料の準備                             │ │   │
│     │ │ │ - デザインレビューの準備                      │ │   │
│     │ │ │                                             │ │   │
│     │ │ │ ---                                         │ │   │
│     │ │ │ [大きなMarkdown編集エリア]                   │ │   │
│     │ │ │ カーソルアクティブ、快適な文書編集体験        │ │   │
│     │ │ └─────────────────────────────────────────────┘ │   │
│     │ └─────────────────────────────────────────────────┘   │
│     │                                                       │
│     │ ┌─────────────────────────────────────────────────┐   │
│     │ │ 🎯 集中時間: 2:30 / 4:00  🚀 [クイック集中開始] │   │
│     │ └─────────────────────────────────────────────────┘   │
└─────┴───────────────────────────────────────────────────────┘
```

### 2.2 メモ＆タスク管理画面（Markdownエディタが主役）
```
┌─────────────────────────────────────────────────────────────┐
│ FocusFlow > メモ＆タスク     [🔍] [add] [notifications] [⚙️] │
├─────┬───────────────────────────────────────────────────────┤
│ 🏠  │ ┌─────────────────────────────────────────────────┐   │
│ 📝  │ │ 📝 今日のメモ・思考の整理                        │   │
│ 🎯  │ │ ┌─────────────────────────────────────────────┐ │   │
│ ⚙️  │ │ │ ## 今日の作業ログ                           │ │   │
│─────│ │ │                                             │ │   │
│ 📝  │ │ │ ### 技術調査                                │ │   │
│Tasks│ │ │ - React コンポーネント設計の方針決定         │ │   │
│     │ │ │ - API仕様書のレビュー完了                    │ │   │
│React│ │ │                                             │ │   │
│API  │ │ │ ### 💡 アイデア・気づき                      │ │   │
│Mail │ │ │ タスクの並び順をドラッグで変更できると        │ │   │
│     │ │ │ 直感的かも。優先度に頼らない管理方法。        │ │   │
│[+]  │ │ │                                             │ │   │
│     │ │ │ ### 📋 明日への引き継ぎ                      │ │   │
│     │ │ │ - 会議資料の準備                             │ │   │
│     │ │ │ - デザインレビューの準備                      │ │   │
│     │ │ │                                             │ │   │
│     │ │ │ ### 🎯 集中セッション記録                    │ │   │
│     │ │ │ - React設計 60分 (16:00-17:00)             │ │   │
│     │ │ │ - API調査 30分 (17:15-17:45)               │ │   │
│     │ │ │                                             │ │   │
│     │ │ │ ---                                         │ │   │
│     │ │ │ [大きなMarkdown編集エリア]                   │ │   │
│     │ │ │ 自由記述、思考の整理、アイデアの発展...       │ │   │
│     │ │ └─────────────────────────────────────────────┘ │   │
│     │ └─────────────────────────────────────────────────┘   │
│     │                                                       │
│     │ ┌─────────────────────────────────────────────────┐   │
│     │ │ 🎯 未完了タスク: 1件  🚀 [クイック集中開始]      │   │
│     │ └─────────────────────────────────────────────────┘   │
└─────┴───────────────────────────────────────────────────────┘
```

### 2.3 集中モード
```
┌─────────────────────────────────────────────────────────────┐
│ 集中中                                                 [⚙️] │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│    ┌─────────────────────────────────────────────────┐    │
│    │ 📝 React コンポーネント設計                      │    │
│    │ 見積もり: 60分 | 経過: 23分                     │    │
│    └─────────────────────────────────────────────────┘    │
│                                                             │
│                   ┌─────────────┐                          │
│                   │   37:42     │                          │
│                   │ (大きく表示) │                          │
│                   └─────────────┘                          │
│                                                             │
│              ████████████████░░░░░░░░░░                    │
│                  62% 完了                                   │
│                                                             │
│    ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐    │
│    │ pause   │  │edit_note│  │event_note│  │  stop   │    │
│    │ 一時停止 │  │ タスク  │  │ デイリー │  │ 終了    │    │
│    │         │  │ メモ    │  │ メモ    │  │         │    │
│    └─────────┘  └─────────┘  └─────────┘  └─────────┘    │
│                                                             │
│               中断回数: 1回 | 効率: 85%                     │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 3. アダプティブレイアウト

### 3.1 画面サイズ対応
```css
/* Standard Desktop (1024px - 1439px) */
.desktop-layout {
  grid-template-columns: 280px 1fr;
  gap: 24px;
}

/* Large Desktop (1440px - 1919px) */
@media (min-width: 1440px) {
  .desktop-layout {
    grid-template-columns: 320px 1fr 320px;
    gap: 32px;
  }
  
  .sidebar-content {
    padding: 24px;
  }
}

/* Ultra-wide Desktop (1920px+) */
@media (min-width: 1920px) {
  .desktop-layout {
    max-width: 1600px;
    margin: 0 auto;
  }
}
```

### 3.2 サイドバー展開・折りたたみ
```css
/* Collapsed State */
.sidebar-collapsed {
  width: 64px;
  overflow: hidden;
}

.sidebar-collapsed .nav-text {
  display: none;
}

.sidebar-collapsed .daily-memo {
  display: none;
}

/* Expanded State */
.sidebar-expanded {
  width: 280px;
  transition: width 0.3s ease;
}
```

---

## 4. インタラクション設計

### 4.1 キーボードショートカット
```javascript
const desktopShortcuts = {
  // Basic Navigation
  '1': 'dashboard',
  '2': 'tasks',
  '3': 'focus',
  '4': 'settings',
  
  // Task Management
  'Ctrl+N': 'newTask',
  'Ctrl+Enter': 'startFocus',
  'Ctrl+D': 'duplicateTask',
  'Delete': 'deleteTask',
  
  // Focus Mode
  'Space': 'pauseResume',
  'Escape': 'exitFocus',
  'Ctrl+M': 'quickMemo',
  
  // Navigation
  'Ctrl+1': 'dashboard',
  'Ctrl+2': 'tasks',
  'Ctrl+3': 'focus',
  'Ctrl+/': 'showShortcuts',
  
  // Daily Memo
  'Ctrl+Shift+M': 'focusDailyMemo'
};
```

### 4.2 ドラッグ&ドロップ
```javascript
// タスク並び替え
const dragDropConfig = {
  dragHandle: '.drag-handle',
  dropZone: '.task-list',
  feedbackClass: 'drag-preview',
  constraints: {
    axis: 'vertical',
    containment: 'parent'
  }
};
```

### 4.3 右クリックメニュー
```javascript
const contextMenus = {
  taskCard: [
    { icon: 'play_arrow', text: '集中開始', action: 'startFocus' },
    { icon: 'edit', text: '編集', action: 'editTask' },
    { icon: 'content_copy', text: '複製', action: 'duplicateTask' },
    { icon: 'delete', text: '削除', action: 'deleteTask' }
  ],
  
  dailyMemo: [
    { icon: 'content_copy', text: 'コピー', action: 'copyMemo' },
    { icon: 'clear', text: 'クリア', action: 'clearMemo' }
  ]
};
```

---

## 5. パフォーマンス最適化

### 5.1 レイアウト最適化
```css
/* GPU加速の活用 */
.sidebar {
  transform: translateZ(0);
  will-change: transform;
}

/* 効率的な再描画 */
.task-list {
  contain: layout style paint;
}

/* 仮想化対応 */
.task-list-container {
  height: 400px;
  overflow-y: auto;
}
```

### 5.2 メモリ使用量
```javascript
// 効率的なタスクレンダリング
const TaskList = memo(({ tasks }) => {
  const visibleTasks = useMemo(() => 
    tasks.slice(0, 50), // 初期表示は50件まで
    [tasks]
  );
  
  return (
    <VirtualizedList 
      items={visibleTasks}
      itemHeight={72}
      renderItem={TaskCard}
    />
  );
});
```

---

## 6. アクセシビリティ

### 6.1 フォーカス管理
```javascript
// フォーカストラップ
const focusTraps = {
  sidebar: {
    first: '.sidebar nav a:first-child',
    last: '.daily-memo textarea'
  },
  
  modal: {
    first: '.modal-header .close-button',
    last: '.modal-footer .primary-button'
  }
};
```

### 6.2 スクリーンリーダー対応
```html
<!-- サイドバーナビゲーション -->
<nav role="navigation" aria-label="メインナビゲーション">
  <ul>
    <li><a href="/dashboard" aria-current="page">ダッシュボード</a></li>
    <li><a href="/tasks">タスク管理</a></li>
    <li><a href="/focus">集中モード</a></li>
  </ul>
</nav>

<!-- メインコンテンツ -->
<main role="main" aria-label="メインコンテンツ">
  <h1>今日のタスク</h1>
  <section aria-label="タスク一覧">
    <!-- タスク一覧 -->
  </section>
</main>
```

---

## 7. 設計判断の記録

### 7.1 Phase 1に合わせた簡素化
**決定**: 3カラムレイアウトを2カラムに変更
**理由**: Phase 1では統計機能がないため、右パネルが不要
**効果**: 集中力向上、実装コスト削減

### 7.2 デイリーメモのサイドバー統合
**決定**: デイリーメモを左サイドバーに常時表示
**理由**: デスクトップでは長時間作業が多く、思考の記録が頻繁
**効果**: 作業効率向上、思考の中断最小化

### 7.3 集中モードの全画面化
**決定**: 集中モード時は2カラムを維持（サイドバーは折りたたまない）
**理由**: デスクトップでは画面が広く、必要な情報へのアクセスを保持
**効果**: 機能性と集中のバランス

### 7.4 Markdownエディタ中心の設計変更
**決定**: タブレット・PCでは画面の70%以上をデイリーメモ（Markdownエディタ）が占有
**理由**: FocusFlowの本質は「思考の記録と整理」であり、タスクリストより重要
**効果**: 見た目がMarkdownエディタになり、思考の整理に集中できる環境を提供

---

## 8. 実装優先度

### 8.1 Phase 1 必須機能
- [ ] 2カラムレイアウト（サイドバー + メイン）
- [ ] 基本ナビゲーション（4画面）
- [ ] タスク一覧表示
- [ ] 集中モード表示
- [ ] デイリーメモ統合

### 8.2 Phase 1 推奨機能
- [ ] キーボードショートカット（基本）
- [ ] ドラッグ&ドロップ並び替え
- [ ] レスポンシブサイドバー

### 8.3 Phase 2 以降
- [ ] 3カラムレイアウト対応
- [ ] 高度なキーボードショートカット
- [ ] 右クリックメニュー
- [ ] 複数ウィンドウ対応

---

**最終更新**: 2025-07-15  
**Next Review**: Phase 1 実装開始時

---

*この設計は FocusFlow の設計哲学「その日必ず着手するタスクのみを管理する」に基づき、デスクトップ環境での長時間作業に最適化されています。*